
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Radiation model &#8212; GeMMM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'md/radiation';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model performance" href="performance.html" />
    <link rel="prev" title="Fourier series model" href="fourier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="welcome.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/gemmm_logo_light_lower.png" class="logo__image only-light" alt="GeMMM - Home"/>
    <script>document.write(`<img src="../_static/gemmm_logo_dark_lower.png" class="logo__image only-dark" alt="GeMMM - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Telecoms data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier.html">Fourier series model</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Radiation model</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Model performance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notebooks/example.html">Using GeMMM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bib.html">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Code documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../rst/autodoc-model.html">model</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/md/radiation.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Radiation model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="radiation-model">
<h1>Radiation model<a class="headerlink" href="#radiation-model" title="Link to this heading">#</a></h1>
<p>Pairs of MSOAs not modelled using a Fourier series are less likely to have significant structure in their time series of journey numbers. Rather than modelling each pair separately, we therefore apply a more global approach. The gravity model has been a popular choice for describing migration and commuting patterns and is based on the assumption that the average number of individuals travelling between two areas is proportional to the population of the areas and inversely proportional to the distance between them<span id="id1"><sup><a class="reference internal" href="bib.html#id9" title="Hugo Barbosa, Marc Barthelemy, Gourab Ghoshal, Charlotte R James, Maxime Lenormand, Thomas Louail, Ronaldo Menezes, José J Ramasco, Filippo Simini, and Marcello Tomasini. Human mobility: models and applications. Physics Reports, 2018. doi:10.1016/j.physrep.2018.01.001.">8</a></sup></span>. Relying solely on the population and distance implies that pairs with similar populations and distance should have comparable fluxes, yet examples exist where movement patterns differ by orders of magnitude. Nowadays, the radiation model is seen as a preferred choice. Whilst this model also considers the population of the two areas, it incorporates an additional variable: the population within a circle centred at the start location, with radius equal to the distance between the two areas<span id="id2"><sup><a class="reference internal" href="bib.html#id10" title="Filippo Simini, Marta C González, Amos Maritan, and Albert-László Barabási. A universal model for mobility and migration patterns. Nature, 2012. doi:10.1038/nature10856.">9</a></sup></span>. This population serves as a proxy for the resources, such as employment opportunities, accessible to individuals in the start location. Longer journeys are assumed to be less likely if similar opportunities can be found at an equal or shorter distance.</p>
<p><font size='4'> <strong>Mathematical description</strong> </font> <br>
Let <span class="math notranslate nohighlight">\(n_i\)</span> and <span class="math notranslate nohighlight">\(n_j\)</span> be the populations of start MSOA <span class="math notranslate nohighlight">\(i\)</span> and end MSOA <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(r_{i,j}\)</span> be the distance in kilometers between the MSOAs, and <span class="math notranslate nohighlight">\(s_{i,j}\)</span> be the population inside a ring of radius <span class="math notranslate nohighlight">\(r_{i,j}\)</span> centered on the start MSOA. The radiation model assumes that the number of journeys between the start and end MSOA is Poisson distributed with mean:</p>
<div class="math notranslate nohighlight">
\[
T_{i,j}(\theta_h) = \theta_h \frac{n_i^2 n_j}{(n_i + s_{i,j})(n_i + n_j + s_{i,j})} \, .
\]</div>
<p>In the original radiation model, <span class="math notranslate nohighlight">\(\theta_h\)</span> represents the proportion of residents in the start MSOA that commute. However, to make full use of the hourly journey counts provided by the mobile telecoms data, we instead define it such that <span class="math notranslate nohighlight">\(\theta_h n_i\)</span> is the number of individuals moving from the start MSOA during hour <span class="math notranslate nohighlight">\(h\)</span>. Note that using the population of the start MSOA is a simplification since it does not account for individuals that have entered and exited the MSOA in preceding hours. When considering the distance between MSOAs, the geodesic distance can lead to underestimates of the population <span class="math notranslate nohighlight">\(s_{i,j}\)</span> and therefore overestimate the connectivity of the MSOAs. To avoid this, <span class="math notranslate nohighlight">\(r_{i,j}\)</span> is defined more precisely to be the road distance between the MSOAs. The road distances between all pairs of MSOAs are obtained using the <a class="reference external" href="https://project-osrm.org/">Open Source Routing Machine</a>.</p>
<p>The map below shows the centroids of MSOAs that are included in the definition of <span class="math notranslate nohighlight">\(s_{i,j}\)</span> for a single MSOA pair. Blue dots represent those included when the geodesic distance is used, red dots are the additional MSOAs included when using the road distance, and grey dots are MSOAs excluded by both methods. The black line marks the driving route used to define the road distance between the MSOAs. The extreme difference between methods is particularly apparent when considering coastal MSOAs.</p>
<a class="reference internal image-reference" href="../_images/radiation_distance_lower.png"><img alt="" class="align-center" src="../_images/radiation_distance_lower.png" style="width: 50%;" />
</a>
<br>
<p><font size='4'> <strong>Parameter estimation</strong> </font> <br>
The parameters <span class="math notranslate nohighlight">\(n_i\)</span>, <span class="math notranslate nohighlight">\(n_j\)</span> and <span class="math notranslate nohighlight">\(s_{i,j}\)</span> are all properties of the start and end MSOA and are therefore known, leaving <span class="math notranslate nohighlight">\(\theta_h\)</span> as the only free parameter in the model. To estimate <span class="math notranslate nohighlight">\(\theta_h\)</span> for a single hour, let <span class="math notranslate nohighlight">\((b_0, b_1,...,b_N)\)</span> denote the boundaries of <span class="math notranslate nohighlight">\(N\)</span> consecutive distance intervals such that <span class="math notranslate nohighlight">\(b_0 &lt; b_1 &lt; ... &lt; b_N\)</span> - here, the distance intervals are each set to ten kilometers. If <span class="math notranslate nohighlight">\(\mathcal{X}_v = \{(i,j): b_v &lt; r_{i,j} \leq b_{v+1}\}\)</span> is the set of all MSOA pairs whose road distance lies within the interval <span class="math notranslate nohighlight">\((b_v, b_{v+1}]\)</span>, then the total number of journeys that occur between these MSOAs is also Poisson distributed with mean</p>
<div class="math notranslate nohighlight">
\[
M_v = \sum_{(i,j) \, \in \, \mathcal{X}_v} T_{i,j}(\theta_h) \, .
\]</div>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{X}=(x_{w,v})\)</span> be a matrix of observed values for MSOA pairs not modelled by a Fourier series, such that <span class="math notranslate nohighlight">\(x_{w,v}\)</span> is the total number of journeys in distance interval <span class="math notranslate nohighlight">\(v\)</span> during week <span class="math notranslate nohighlight">\(w\)</span>. The log-likelihood of these observations is then given by</p>
<div class="math notranslate nohighlight">
\[
    l(\mathbf{X};\theta_h) = \sum_{w}\sum_{v} \left(x_{w,v} \log(M_v) - M_v\right) \, .
\]</div>
<p>Posterior probability likelihood distributions for each <span class="math notranslate nohighlight">\(\theta_h\)</span> can be obtained independently using the Python MCMC implementation <a class="reference external" href="https://emcee.readthedocs.io/en/stable/">emcee</a> with the above log-likelihood<span id="id3"><sup><a class="reference internal" href="bib.html#id11" title="Daniel Foreman-Mackey, David W Hogg, Dustin Lang, and Jonathan Goodman. Emcee: the mcmc hammer. Publications of the Astronomical Society of the Pacific, 2013. doi:10.1086/670067.">10</a></sup></span>. Weekday and weekend posterior median estimates for <span class="math notranslate nohighlight">\(\theta_h\)</span> are provided below. For weekdays, two distinct peaks occur at common commuting times, with low estimates during the night. Over the weekend, however, a single prolonged peak exists from late-morning to late-afternoon.</p>
<a class="reference internal image-reference" href="../_images/radiation_theta.png"><img alt="" class="align-center" src="../_images/radiation_theta.png" style="width: 75%;" />
</a>
<p>With these posterior median estimates of <span class="math notranslate nohighlight">\(\theta_h\)</span>, realizations of journey numbers during hour <span class="math notranslate nohighlight">\(h\)</span> can be generated by sampling from a Poisson distribution with mean <span class="math notranslate nohighlight">\(T_{i,j}(\theta_h)\)</span>.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./md"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="fourier.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Fourier series model</p>
      </div>
    </a>
    <a class="right-next"
       href="performance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model performance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By UK Health Security Agency
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div>
  &copy Crown Copyright 2025
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>